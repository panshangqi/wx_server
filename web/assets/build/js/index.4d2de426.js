!function(e){function t(t){for(var a,u,r=t[0],s=t[1],o=t[2],d=0,f=[];d<r.length;d++)u=r[d],l[u]&&f.push(l[u][0]),l[u]=0;for(a in s)Object.prototype.hasOwnProperty.call(s,a)&&(e[a]=s[a]);for(c&&c(t);f.length;)f.shift()();return i.push.apply(i,o||[]),n()}function n(){for(var e,t=0;t<i.length;t++){for(var n=i[t],a=!0,r=1;r<n.length;r++){var s=n[r];0!==l[s]&&(a=!1)}a&&(i.splice(t--,1),e=u(u.s=n[0]))}return e}var a={},l={2:0},i=[];function u(t){if(a[t])return a[t].exports;var n=a[t]={i:t,l:!1,exports:{}};return e[t].call(n.exports,n,n.exports,u),n.l=!0,n.exports}u.m=e,u.c=a,u.d=function(e,t,n){u.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},u.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},u.t=function(e,t){if(1&t&&(e=u(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(u.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var a in e)u.d(n,a,function(t){return e[t]}.bind(null,a));return n},u.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return u.d(t,"a",t),t},u.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},u.p="../";var r=window.webpackJsonp=window.webpackJsonp||[],s=r.push.bind(r);r.push=t,r=r.slice();for(var o=0;o<r.length;o++)t(r[o]);var c=s;i.push([704,0]),n()}({65:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=o(n(112)),l=o(n(107)),i=o(n(160)),u=o(n(293)),r=o(n(135));n(108),n(124);var s=o(n(0));function o(e){return e&&e.__esModule?e:{default:e}}n(294);var c=r.default.confirm,d={};function f(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},a=arguments[3],l=arguments[4],i=(new Date).getTime(),o=n,c=t,f={method:e,credentials:"include",headers:{"X-Requested-With":"XMLHttpRequest","Content-Type":"application/json",Accept:"application/json; charset=utf-8"}};o.t=i;var h=d.cookies.get_cookies();(f.headers.token=h&&h.token||"",f.headers.username=h&&h.username||"","post"==e||"put"==e)?f.body=(0,u.default)(o):c=t+"?"+function(e){var t="";for(var n in e)""!=t&&(t+="&"),t+=n+"="+e[n];return t}(o);fetch(c,f).then(function(e){var t=e.status,n=[];if(t>=200&&t<300)return e;400===t||500===t?n.push("我们正在努力解决问题"):401===t?n.push("您尚未登录"):403===t?n.push("你无权限访问"):404===t?n.push("未发现所请求的资源"):403===t?n.push("没有权限或访问的资源不属于此账号"):502===t&&n.push("服务正在升级，请稍后重试！"),"function"==typeof l&&l(t),n.push("("+e.statusText+")");var a=new Error;throw a.name=t,a.message=n.join("\n"),a.res=e,a}).then(function(e){return e.json()}).then(function(e){var t,n;"AJAX"==e.type?a(e):(t=e.code,n=e.message,r.default.error({title:t,content:s.default.createElement("div",null,s.default.createElement("p",null,n)),onOk:function(){401===t&&(window.location.href=d.util.make_route("/login"))}}))}).catch(function(e){console.log(e),"function"==typeof l&&l(500),console.log(e.message)})}d.http={get:function(e,t,n,a){return f("get",e,t,n,a)},post:function(e,t,n,a){return f("post",e,t,n,a)},put:function(e,t,n,a){return f("put",e,t,n,a)},_delete:function(e,t,n,a){return f("delete",e,t,n,a)},getSync:function(e,t){return new i.default(function(n,a){d.http.get(e,t,function(e){n(e)},function(e){throw new Error("Http Error Code: "+e)})}).catch(function(e){console.log(e)})},postSync:function(e,t){return new i.default(function(n,a){d.http.post(e,t,function(e){n(e)},function(e){throw new Error("Http Error Code: "+e)})}).catch(function(e){console.log(e)})}},d.util={dataFormat:function(e){var t=new Date(e);return t.getFullYear()+"-"+("0"+(t.getMonth()+1)).slice(-2)+"-"+("0"+t.getDate()).slice(-2)+" "+("0"+t.getHours()).slice(-2)+":"+("0"+t.getMinutes()).slice(-2)+":"+("0"+t.getSeconds()).slice(-2)},make_route:function(e){return"/"==e[0]&&(e=e.substr(1)),"http://"+window.location.host+"/"+e},make_url:function(e){return"/api"+e},make_client_url:function(e){return"/client"+e},get_url_params:function(e){if(!e)return{};var t=e.indexOf("?"),n=e;t>-1&&(n=e.substring(t+1,e.length));var a=n.split("&"),i={},u=!0,r=!1,s=void 0;try{for(var o,c=(0,l.default)(a);!(u=(o=c.next()).done);u=!0){var d=o.value.split("=");i[d[0]]=d[1]}}catch(e){r=!0,s=e}finally{try{!u&&c.return&&c.return()}finally{if(r)throw s}}return i},sleep:function(e){return new i.default(function(t,n){setTimeout(function(){t(e)},e)})},get_file_suffix:function(e){return e.substring(e.lastIndexOf(".")+1)},loading:function(e,t){e?(a.default.config({top:250,content:"",duration:20}),a.default.loading(t)):a.default.destroy()},confirmDialog:function(e,t){return new i.default(function(n,a){c({title:e,content:t,onOk:function(){n(!0)},onCancel:function(){n(!1)}})})},toDataUrl:function(e,t){return new i.default(function(n,a){var l=new XMLHttpRequest;l.onload=function(){var e=new FileReader;e.onloadend=function(){"function"==typeof t&&t(e.result),n(e.result)},e.readAsDataURL(l.response)},l.open("GET",e),l.responseType="blob",l.send()})}},d.cookies={set_cookies:function(e){localStorage.setItem("wx_server_auth",(0,u.default)(e))},get_cookies:function(){var e=localStorage.getItem("wx_server_auth");return e?JSON.parse(e):null},del_cookies:function(){window.localStorage.removeItem("wx_server_auth")}},t.default=d},704:function(e,t,n){e.exports=n(705)},705:function(e,t,n){"use strict";var a=b(n(6)),l=b(n(66)),i=b(n(77)),u=b(n(9)),r=b(n(17)),s=b(n(7)),o=b(n(10));n(234);var c=b(n(0)),d=b(n(5)),f=n(228),h=n(40);n(875),n(890);var m=b(n(706)),p=b(n(716)),v=b(n(717)),g=b(n(720)),_=b(n(721)),y=b(n(722)),k=b(n(65));function b(e){return e&&e.__esModule?e:{default:e}}var E=(0,h.createBrowserHistory)();document.onreadystatechange=function(){console.log(document.readyState),document.readyState};var x=function(e){function t(){(0,u.default)(this,t);var e=(0,s.default)(this,(t.__proto__||(0,i.default)(t)).call(this));return e.state={},e}return(0,o.default)(t,e),(0,r.default)(t,[{key:"componentDidMount",value:function(){console.log("init auth routeex")}},{key:"PrivateRoute",value:function(e){var t=e.component,n=(0,l.default)(e,["component"]);return null!==k.default.cookies.get_cookies()?c.default.createElement(f.Route,(0,a.default)({},n,{render:function(e){return c.default.createElement(t,e)}})):c.default.createElement("div",null,"登录失效, 请重新登录 ",c.default.createElement(f.Link,{to:"/login"},"去登录"))}},{key:"render",value:function(){return c.default.createElement(f.Router,{history:E},c.default.createElement(y.default,null,c.default.createElement(f.Switch,null,c.default.createElement(f.Route,{exact:!0,path:"/login",component:m.default}),c.default.createElement(this.PrivateRoute,{exact:!0,path:"/home",component:p.default}),c.default.createElement(this.PrivateRoute,{exact:!0,path:"/create_class",component:_.default}),c.default.createElement(this.PrivateRoute,{exact:!0,path:"/sections",component:g.default}),c.default.createElement(this.PrivateRoute,{exact:!0,path:"/edit_class",component:v.default}),c.default.createElement(f.Redirect,{to:"/home"}))))}}]),t}(c.default.Component);d.default.render(c.default.createElement(x,null),document.getElementById("root"))},706:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=v(n(38)),l=v(n(136)),i=v(n(110)),u=v(n(111)),r=v(n(77)),s=v(n(9)),o=v(n(17)),c=v(n(7)),d=v(n(10)),f=v(n(135));n(96),n(133),n(124);var h=n(0),m=v(h),p=v(n(65));function v(e){return e&&e.__esModule?e:{default:e}}n(894);var g=function(e){function t(){(0,s.default)(this,t);var e=(0,c.default)(this,(t.__proto__||(0,r.default)(t)).call(this));return e.state={visible:!1,username:"",password:""},e}return(0,d.default)(t,e),(0,o.default)(t,[{key:"componentDidMount",value:function(){this.checkLogin()}},{key:"checkLogin",value:function(){var e=(0,u.default)(i.default.mark(function e(){var t;return i.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,p.default.http.getSync("/client/check/login/status");case 2:t=e.sent,console.log("login status",t),t&&"AJAX"==t.type&&"success"==t.body.status&&this.props.history.push("/home");case 5:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"componentWillUnmount",value:function(){}},{key:"login",value:function(){var e=(0,u.default)(i.default.mark(function e(){var t;return i.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,p.default.http.postSync("/client/login",{username:this.state.username,password:this.state.password});case 2:if(t=e.sent,console.log(t),!t||"AJAX"!=t.type||"yes"!=t.body.success){e.next=10;break}return p.default.cookies.set_cookies({token:t.body.token,username:t.body.username}),this.props.history.push("/home"),e.abrupt("return");case 10:n="登录失败，请检查账号密码是否正确",f.default.error({title:"提示",content:n,width:500,onOk:function(){}});case 11:case"end":return e.stop()}var n},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e=this;return m.default.createElement("div",{id:"login_html"},m.default.createElement("div",{className:"main_logo"}),m.default.createElement("div",{className:"title"},"长青微信小程序中台配置系统"),m.default.createElement("div",{className:"input_info"},m.default.createElement(l.default,{placeholder:"请输入账号",value:this.state.username,onChange:function(t){e.setState({username:t.target.value})}})),m.default.createElement("div",{className:"input_info"},m.default.createElement(l.default.Password,{placeholder:"请输入密码",value:this.state.password,onChange:function(t){e.setState({password:t.target.value})}})),m.default.createElement("div",{className:"input_info"},m.default.createElement(a.default,{className:"login_btn",type:"primary",onClick:this.login.bind(this),style:{width:"100%"}},"登 录")))}}]),t}(h.Component);t.default=g},716:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=y(n(135)),l=y(n(136)),i=y(n(107)),u=y(n(38)),r=y(n(12)),s=y(n(112)),o=y(n(110)),c=y(n(111)),d=y(n(77)),f=y(n(9)),h=y(n(17)),m=y(n(7)),p=y(n(10));n(124),n(133),n(96),n(134),n(108);var v=n(0),g=y(v),_=y(n(65));function y(e){return e&&e.__esModule?e:{default:e}}n(898);var k=function(e){function t(e){(0,f.default)(this,t);var n=(0,m.default)(this,(t.__proto__||(0,d.default)(t)).call(this,e));return n.state={visible:!1,name:"",classes:[]},n}return(0,p.default)(t,e),(0,h.default)(t,[{key:"componentDidMount",value:function(){this.get_classes()}},{key:"componentWillUnmount",value:function(){}},{key:"get_classes",value:function(){var e=(0,c.default)(o.default.mark(function e(){var t;return o.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,_.default.http.getSync(_.default.util.make_url("/get_classes"),{class_id:-1});case 2:t=e.sent,console.log(t,"=============="),t.body.sort(function(e,t){return t.create_time-e.create_time}),this.setState({classes:t.body});case 7:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"onCreateClick",value:function(){this.props.history.push("/create_class")}},{key:"createPost",value:function(){var e=(0,c.default)(o.default.mark(function e(){var t;return o.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(this.state.name){e.next=3;break}return s.default.warning("名字不能为空"),e.abrupt("return");case 3:return this.setState({visible:!1}),e.next=6,_.default.http.postSync(_.default.util.make_url("/create_class"),{name:this.state.name});case 6:return t=e.sent,console.log(t),e.next=10,this.get_classes();case 10:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"deletePost",value:function(){var e=(0,c.default)(o.default.mark(function e(t){var n,a,l;return o.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t._id,a=t.name,!t.section_count){e.next=5;break}return s.default.warning("请先删除章节内容"),e.abrupt("return");case 5:return e.next=7,_.default.util.confirmDialog("提示","确定删除【"+a+"】？");case 7:if(e.sent){e.next=10;break}return e.abrupt("return");case 10:return e.next=12,_.default.http.postSync(_.default.util.make_url("/delete_class"),{class_id:n});case 12:l=e.sent,console.log(l),this.get_classes();case 15:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"onNameChange",value:function(e){console.log(e.target.value),this.setState({name:e.target.value})}},{key:"render_class_list",value:function(){var e=this,t=[],n=function(n){var a=n._id,l=_.default.util.dataFormat(n.create_time);t.push(g.default.createElement("div",{className:"item_box",key:a},g.default.createElement("div",{className:"left"},g.default.createElement("div",{className:"title"},n.title,g.default.createElement("span",{className:"sub_title"},"(",n.sub_title,")")),g.default.createElement("div",{className:"introduction"},g.default.createElement("span",null,"课程简介："),n.introduction),g.default.createElement("span",{className:"info"},g.default.createElement("span",null,"id:")," ",a),g.default.createElement("span",{className:"info"},g.default.createElement("span",null,"创建时间:")," ",l)),g.default.createElement("div",{className:"right"},g.default.createElement(u.default,{type:"primary",onClick:function(){console.log(n.id),e.props.history.push("/sections?id="+a+"&name="+n.name)}},"编辑章节",g.default.createElement(r.default,{type:"form"})),g.default.createElement(u.default,{type:"primary",className:"modify",onClick:function(){console.log(n.id),e.props.history.push("/create_class?id="+a+"&name="+n.name)}},"修改课程",g.default.createElement(r.default,{type:"edit"})),g.default.createElement(u.default,{type:"danger",className:"delete",onClick:function(){e.deletePost(n)}},"删除",g.default.createElement(r.default,{type:"delete"})))))},a=!0,l=!1,s=void 0;try{for(var o,c=(0,i.default)(this.state.classes);!(a=(o=c.next()).done);a=!0){n(o.value)}}catch(e){l=!0,s=e}finally{try{!a&&c.return&&c.return()}finally{if(l)throw s}}return t}},{key:"render",value:function(){var e=this;return g.default.createElement("div",{className:"home_html"},g.default.createElement("div",{className:"base_page_head"},g.default.createElement(u.default,{type:"primary",onClick:this.onCreateClick.bind(this)},g.default.createElement(r.default,{type:"plus"}),"创建新套课")),this.render_class_list(),g.default.createElement(a.default,{title:"创建",visible:this.state.visible,okText:"确认",cancelText:"取消",okButtonProps:{disabled:!1},onOk:function(){e.createPost()},onCancel:function(){e.setState({visible:!1})}},"套课名称：",g.default.createElement(l.default,{style:{width:300},value:this.state.name,onChange:this.onNameChange.bind(this)})))}}]),t}(v.Component);t.default=k},717:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=E(n(38)),l=E(n(12)),i=E(n(112)),u=E(n(110)),r=E(n(107)),s=E(n(111)),o=E(n(77)),c=E(n(9)),d=E(n(17)),f=E(n(7)),h=E(n(10)),m=E(n(160)),p=E(n(136));n(96),n(134),n(108),n(133);var v=n(0),g=E(v),_=E(n(65)),y=E(n(227));n(900);var k=E(n(718)),b=E(n(719));function E(e){return e&&e.__esModule?e:{default:e}}p.default.TextArea;function x(e,t){return new m.default(function(n,a){var l=new XMLHttpRequest;l.onload=function(){var e=new FileReader;e.onloadend=function(){"function"==typeof t&&t(e.result),n(e.result)},e.readAsDataURL(l.response)},l.open("GET",e),l.responseType="blob",l.send()})}var w=function(e){function t(e){(0,c.default)(this,t);var n=(0,f.default)(this,(t.__proto__||(0,o.default)(t)).call(this,e));return console.log(window.location.search),n.search=_.default.util.get_url_params(decodeURIComponent(window.location.search)),console.log(n.search),n.cls_id=n.search.id,n.cls_name=n.search.name,n.state={content:[],title:"",author:"",music:{audio:"",extension:""},visible:!1,section_info:null},n}return(0,h.default)(t,e),(0,d.default)(t,[{key:"componentDidMount",value:function(){this.action="create",this.search.section_id&&"modify"==this.search.type&&(this.action="modify",this.init())}},{key:"componentWillUnmount",value:function(){}},{key:"init",value:function(){var e=(0,s.default)(u.default.mark(function e(){var t,n,a,l,i,s,o,c,d,f=this;return u.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,_.default.http.getSync(_.default.util.make_url("/get_sections"),{class_id:this.cls_id,section_id:this.search.section_id});case 2:t=e.sent,console.log(t),n=t.body,x(n.music.audio,function(e){f.setState({music:{audio:e,extension:n.music.extension}})}),a=!0,l=!1,i=void 0,e.prev=10,s=(0,r.default)(n.content);case 12:if(a=(o=s.next()).done){e.next=22;break}if(!("image"in(c=o.value))){e.next=19;break}return e.next=17,x(c.image);case 17:d=e.sent,c.image=d;case 19:a=!0,e.next=12;break;case 22:e.next=28;break;case 24:e.prev=24,e.t0=e.catch(10),l=!0,i=e.t0;case 28:e.prev=28,e.prev=29,!a&&s.return&&s.return();case 31:if(e.prev=31,!l){e.next=34;break}throw i;case 34:return e.finish(31);case 35:return e.finish(28);case 36:console.log(n),this.setState({section_info:n,title:n.title,author:n.author,content:n.content});case 38:case"end":return e.stop()}},e,this,[[10,24,28,36],[29,,31,35]])}));return function(){return e.apply(this,arguments)}}()},{key:"onSubmitClick",value:function(){var e=(0,s.default)(u.default.mark(function e(){var t,n,a,l,s,o,c,d,f,h,m,p;return u.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(this.state.title){e.next=3;break}return i.default.warning("标题不能为空"),e.abrupt("return");case 3:if(this.state.music.extension){e.next=6;break}return i.default.warning("音乐未选择"),e.abrupt("return");case 6:if(this.state.author){e.next=9;break}return i.default.warning("作者不能为空"),e.abrupt("return");case 9:_.default.util.loading(!0,"正在发送"),t=this.state.title,n=this.state.author,a=this.state.music,l=this.state.content,s=!0,o=!1,c=void 0,e.prev=17,d=(0,r.default)(l);case 19:if(s=(f=d.next()).done){e.next=34;break}if(!("text"in(h=f.value))){e.next=27;break}if(h.text){e.next=25;break}return i.default.warning("段落不能为空"),e.abrupt("return");case 25:e.next=31;break;case 27:if(!("image"in h)){e.next=31;break}if(h.extension){e.next=31;break}return i.default.warning("图片未选择"),e.abrupt("return");case 31:s=!0,e.next=19;break;case 34:e.next=40;break;case 36:e.prev=36,e.t0=e.catch(17),o=!0,c=e.t0;case 40:e.prev=40,e.prev=41,!s&&d.return&&d.return();case 43:if(e.prev=43,!o){e.next=46;break}throw c;case 46:return e.finish(43);case 47:return e.finish(40);case 48:return m={title:t,author:n,music:a,content:l},console.log(m),e.next=52,_.default.http.postSync(_.default.util.make_url("/create_and_update_section"),{data:m,class_id:this.cls_id,section_id:this.search.section_id||"",action:this.action});case 52:p=e.sent,console.log(p),_.default.util.loading(!1,"正在发送"),this.props.history.push("/sections?id="+this.cls_id+"&name="+this.cls_name);case 56:case"end":return e.stop()}},e,this,[[17,36,40,48],[41,,43,47]])}));return function(){return e.apply(this,arguments)}}()},{key:"onPreviewClick",value:function(){(0,y.default)("#phone_box").show(500)}},{key:"renderPhoneContent",value:function(){var e=[],t=10010;e.push(g.default.createElement("div",{className:"article-title",key:t++},this.state.title)),e.push(g.default.createElement("div",{className:"music-player",key:t++},g.default.createElement("div",{className:"music-header"},g.default.createElement("img",{src:b.default})),g.default.createElement("div",{className:"music-info"},g.default.createElement("div",{className:"music-title"},this.state.title),g.default.createElement("div",{className:"music-author"},this.state.author),g.default.createElement("div",{className:"music-progress"},g.default.createElement("div",{className:"timer"},"00:00"),g.default.createElement("div",{className:"progress-bar"}),g.default.createElement("div",{className:"timer"},"00:00")))));var n=!0,a=!1,l=void 0;try{for(var i,u=(0,r.default)(this.state.content);!(n=(i=u.next()).done);n=!0){var s=i.value;"text"in s?e.push(g.default.createElement("div",{className:"article-text",key:t++},s.text)):"image"in s&&e.push(g.default.createElement("div",{className:"article-image",key:t++},g.default.createElement("img",{src:s.image})))}}catch(e){a=!0,l=e}finally{try{!n&&u.return&&u.return()}finally{if(a)throw l}}return e}},{key:"onChangeAudio",value:function(e){var t=this,n=document.getElementById("audio_upload").files[0];if(console.log(n),n.size>10485760)i.default.warning("音频大小不能超过10MB");else{var a=_.default.util.get_file_suffix(n.name),l=new FileReader;l.readAsDataURL(n),l.onload=function(e){var n=e.target.result;t.setState({music:{audio:n,extension:a}}),(0,y.default)("#audio_mp3").attr("src",n)}}}},{key:"onUploadImageClick",value:function(e,t){(0,y.default)("#content-eles-"+e).find("input")[0].click()}},{key:"onChangeImage",value:function(e,t){var n=this,a=this.state.content,l=a[e],u=(0,y.default)("#content-eles-"+e).find("input")[0].files[0];if(console.log(u),u.size>1048576)i.default.warning("图片大小不能超过1MB");else{var r=_.default.util.get_file_suffix(u.name),s=new FileReader;s.readAsDataURL(u),s.onload=function(e){var t=e.target.result;l.image=t,l.extension=r,n.setState({content:a})},console.log(e)}}},{key:"addText",value:function(){var e=this.state.content;e.push({text:null}),this.setState({content:e})}},{key:"addImage",value:function(){var e=this.state.content;e.push({image:null}),this.setState({content:e})}},{key:"onTextChange",value:function(e,t){var n=this.state.content;n[e].text=t.target.value,this.setState({content:n})}},{key:"onOpClick",value:function(e,t){var n=this.state.content,a=n.length;if("up"==e&&t>0){var l=n[t-1];n[t-1]=n[t],n[t]=l}else if("down"==e&&t+1<a){var i=n[t+1];n[t+1]=n[t],n[t]=i}else"del"==e&&n.splice(t,1);this.setState({content:n})}},{key:"renderOpBtns",value:function(e){var t="op_button",n=t;return 0==e&&(t+=" disable"),e==this.state.content.length-1&&(n+=" disable"),g.default.createElement("div",null,g.default.createElement(l.default,{type:"arrow-up",className:t,onClick:this.onOpClick.bind(this,"up",e)}),g.default.createElement(l.default,{type:"arrow-down",className:n,onClick:this.onOpClick.bind(this,"down",e)}),g.default.createElement(l.default,{type:"close",className:"op_button delete",onClick:this.onOpClick.bind(this,"del",e)}))}},{key:"renderContent",value:function(){var e=[],t=0,n=(this.state.content.length,!0),i=!1,u=void 0;try{for(var s,o=(0,r.default)(this.state.content);!(n=(s=o.next()).done);n=!0){var c=s.value;"image"in c?e.push(g.default.createElement("div",{className:"content-eles",id:"content-eles-"+t,key:t,tag:"image"},g.default.createElement("div",{className:"left_btns"},g.default.createElement(a.default,{type:"primary",className:"upload_btn",onClick:this.onUploadImageClick.bind(this,t)},g.default.createElement(l.default,{type:"upload"}),"上传"),g.default.createElement("span",{className:"tip"},"图片大小不能超过1M"),g.default.createElement("input",{type:"file",onChange:this.onChangeImage.bind(this,t),style:{display:"none"}}),g.default.createElement("img",{src:c.image})),g.default.createElement("div",{className:"op_btns"},this.renderOpBtns(t)))):"text"in c&&e.push(g.default.createElement("div",{className:"content-eles",id:"content-eles-"+t,key:t,tag:"text"},g.default.createElement("div",{className:"left_btns"},"文本：",g.default.createElement("textarea",{value:c.text,onChange:this.onTextChange.bind(this,t)})),g.default.createElement("div",{className:"op_btns"},this.renderOpBtns(t)))),t++}}catch(e){i=!0,u=e}finally{try{!n&&o.return&&o.return()}finally{if(i)throw u}}return e}},{key:"onTitleChange",value:function(e){this.setState({title:e.target.value})}},{key:"onAuthorChange",value:function(e){this.setState({author:e.target.value})}},{key:"toBackClick",value:function(){var e=(0,s.default)(u.default.mark(function e(){return u.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,_.default.util.confirmDialog("提示","返回将不保留任何信息，确定退出？");case 2:e.sent&&this.props.history.push("/sections?id="+this.cls_id+"&name="+this.cls_name);case 4:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"render",value:function(){return g.default.createElement("div",{className:"edit_html"},g.default.createElement("div",{className:"base_page_head"},g.default.createElement("span",{className:"class_name",onClick:this.toBackClick.bind(this)},g.default.createElement(l.default,{type:"rollback"}),this.cls_name),g.default.createElement(a.default,{type:"primary",onClick:this.onSubmitClick.bind(this)},"提交"),g.default.createElement(a.default,{type:"primary",onClick:this.onPreviewClick.bind(this),style:{marginLeft:20}},"手机效果预览")),g.default.createElement("div",null,"标题： ",g.default.createElement(p.default,{value:this.state.title,onChange:this.onTitleChange.bind(this),style:{width:300}})),g.default.createElement("div",{className:"cut_line"}),g.default.createElement("div",null,"作者： ",g.default.createElement(p.default,{value:this.state.author,onChange:this.onAuthorChange.bind(this),style:{width:300}})),g.default.createElement("div",{className:"cut_line"}),g.default.createElement("div",{className:"audio_box"},"音频：",g.default.createElement("input",{type:"file",id:"audio_upload",onChange:this.onChangeAudio.bind(this)}),g.default.createElement("audio",{controls:!0,id:"audio_mp3",className:"audio_play",src:this.state.music.audio},g.default.createElement("source",{type:"audio/mpeg"})),g.default.createElement("span",{className:"tip"},"音频大小不能超过10M")),g.default.createElement("div",{className:"cut_line"}),g.default.createElement("div",{className:"edit_content"},"内容：",g.default.createElement(a.default,{type:"primary",onClick:this.addImage.bind(this)},"插入图片"),g.default.createElement(a.default,{type:"primary",style:{marginLeft:20},onClick:this.addText.bind(this)},"插入文字")),this.renderContent(),g.default.createElement("div",{className:"phone_box",id:"phone_box",onClick:function(){(0,y.default)("#phone_box").hide(500)}},g.default.createElement("img",{className:"phone_bg",src:k.default}),g.default.createElement("div",{className:"phone_content"},this.renderPhoneContent())))}}]),t}(v.Component);t.default=w},718:function(e,t,n){e.exports=n.p+"imgs/phone_box.97329be2.png"},719:function(e,t,n){e.exports=n.p+"imgs/header-music.8eedb50d.png"},720:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=_(n(135)),l=_(n(136)),i=_(n(12)),u=_(n(112)),r=_(n(110)),s=_(n(111)),o=_(n(77)),c=_(n(9)),d=_(n(17)),f=_(n(7)),h=_(n(10)),m=_(n(107));n(124),n(133),n(134),n(108);var p=n(0),v=_(p),g=_(n(65));function _(e){return e&&e.__esModule?e:{default:e}}function y(e){var t="",n=!0,a=!1,l=void 0;try{for(var i,u=(0,m.default)(e);!(n=(i=u.next()).done);n=!0){var r=i.value;"text"in r&&(t+=r.text)}}catch(e){a=!0,l=e}finally{try{!n&&u.return&&u.return()}finally{if(a)throw l}}return t}n(902);var k=function(e){function t(e){(0,c.default)(this,t);var n=(0,f.default)(this,(t.__proto__||(0,o.default)(t)).call(this,e));n.state={visible:!1,name:"",sections:[]};var a=g.default.util.get_url_params(decodeURIComponent(window.location.search));return console.log(a),n.cls_id=a.id,n.cls_name=a.name,n}return(0,h.default)(t,e),(0,d.default)(t,[{key:"componentDidMount",value:function(){this.get_sections()}},{key:"componentWillUnmount",value:function(){}},{key:"get_sections",value:function(){var e=(0,s.default)(r.default.mark(function e(){var t,n;return r.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,g.default.http.getSync(g.default.util.make_url("/get_sections"),{class_id:this.cls_id});case 2:t=e.sent,console.log(t),(n=t.body).sort(function(e,t){return t.create_time-e.create_time}),this.setState({sections:n});case 7:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"onCreateClick",value:function(){this.props.history.push("/edit_class?id="+this.cls_id+"&name="+this.cls_name)}},{key:"onModifyClick",value:function(e){this.props.history.push("/edit_class?id="+this.cls_id+"&name="+this.cls_name+"&section_id="+e+"&type=modify")}},{key:"createPost",value:function(){var e=(0,s.default)(r.default.mark(function e(){var t;return r.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(this.state.name){e.next=3;break}return u.default.warning("名字不能为空"),e.abrupt("return");case 3:return this.setState({visible:!1}),e.next=6,g.default.http.postSync(g.default.util.make_url("/create_class"),{name:this.state.name});case 6:return t=e.sent,console.log(t),e.next=10,this.get_classes();case 10:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"onNameChange",value:function(e){console.log(e.target.value),this.setState({name:e.target.value})}},{key:"render_class_list",value:function(){var e=[],t=!0,n=!1,a=void 0;try{for(var l,i=(0,m.default)(this.state.sections);!(t=(l=i.next()).done);t=!0){var u=l.value,r=u._id;g.default.util.dataFormat(u.create_time);e.push(v.default.createElement("div",{className:"section",onClick:this.onModifyClick.bind(this,r),key:r},v.default.createElement("div",{className:"title"},u.title),v.default.createElement("div",{className:"sub_title"},v.default.createElement("span",null,"简介："),y(u.content))))}}catch(e){n=!0,a=e}finally{try{!t&&i.return&&i.return()}finally{if(n)throw a}}return e}},{key:"render",value:function(){var e=this;return v.default.createElement("div",{className:"sections_html"},v.default.createElement("div",{className:"base_page_head"},v.default.createElement("div",{className:"class_name"},this.cls_name)),v.default.createElement("div",{className:"section_list"},v.default.createElement("div",{className:"section",onClick:this.onCreateClick.bind(this)},v.default.createElement(i.default,{type:"plus",className:"add_icon"})),this.render_class_list()),v.default.createElement(a.default,{title:"创建",visible:this.state.visible,okText:"确认",cancelText:"取消",okButtonProps:{disabled:!1},onOk:function(){e.createPost()},onCancel:function(){e.setState({visible:!1})}},"套课名称：",v.default.createElement(l.default,{style:{width:300},value:this.state.name,onChange:this.onNameChange.bind(this)})))}}]),t}(p.Component);t.default=k},721:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=_(n(136)),l=_(n(38)),i=_(n(12)),u=_(n(112)),r=_(n(110)),s=_(n(111)),o=_(n(77)),c=_(n(9)),d=_(n(17)),f=_(n(7)),h=_(n(10));n(133),n(96),n(134),n(108);var m=n(0),p=_(m),v=_(n(65)),g=_(n(227));function _(e){return e&&e.__esModule?e:{default:e}}n(904);var y=function(e){function t(e){(0,c.default)(this,t);var n=(0,f.default)(this,(t.__proto__||(0,o.default)(t)).call(this,e));return n.search=v.default.util.get_url_params(decodeURIComponent(window.location.search)),console.log(n.search),n.cls_id=n.search.id,n.cls_name=n.search.name,n.state={visible:!1,name:"",title:"",sub_title:"",introduction:"",background:{image:null,extension:null},classes:[]},n}return(0,h.default)(t,e),(0,d.default)(t,[{key:"componentDidMount",value:function(){this.get_classes()}},{key:"componentWillUnmount",value:function(){}},{key:"get_classes",value:function(){var e=(0,s.default)(r.default.mark(function e(){var t,n,a;return r.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,v.default.http.getSync(v.default.util.make_url("/get_classes"),{class_id:this.cls_id});case 2:return t=e.sent,console.log(t),n=t.body,e.next=7,v.default.util.toDataUrl(n.background.image);case 7:a=e.sent,this.setState({name:n.name,title:n.title,sub_title:n.sub_title,introduction:n.introduction,background:{image:a,extension:n.background.extension}});case 9:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"toBackClick",value:function(){var e=(0,s.default)(r.default.mark(function e(){return r.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,v.default.util.confirmDialog("提示","返回将不保留任何信息，确定退出？");case 2:e.sent&&this.props.history.push("/home");case 4:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"onNameChange",value:function(e){console.log(e.target.value),this.setState({name:e.target.value})}},{key:"onCreateClick",value:function(){var e=(0,s.default)(r.default.mark(function e(){var t;return r.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(this.state.title){e.next=3;break}return u.default.warning("主标题不能为空"),e.abrupt("return");case 3:if(this.state.sub_title){e.next=6;break}return u.default.warning("副标题不能为空"),e.abrupt("return");case 6:if(this.state.background.extension){e.next=9;break}return u.default.warning("背景图片不能为空"),e.abrupt("return");case 9:if(this.state.introduction){e.next=12;break}return u.default.warning("课程简介不能为空"),e.abrupt("return");case 12:return e.next=14,v.default.http.postSync(v.default.util.make_url("/create_class"),{data:{title:this.state.title,sub_title:this.state.sub_title,background:this.state.background,introduction:this.state.introduction},class_id:this.cls_id,action:this.cls_id?"modify":"create"});case 14:t=e.sent,console.log(t),this.props.history.push("/home");case 17:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"onTitleChange",value:function(e,t){"title"==e?this.setState({title:t.target.value}):"sub_title"==e&&this.setState({sub_title:t.target.value})}},{key:"onUploadImageClick",value:function(){(0,g.default)("#main_input").click()}},{key:"onChangeImage",value:function(){var e=this,t=(this.state.background,(0,g.default)("#main_input")[0].files[0]);if(t.size>1048576)u.default.warning("图片大小不能超过1MB");else{var n=v.default.util.get_file_suffix(t.name),a=new FileReader;a.readAsDataURL(t),a.onload=function(t){var a=t.target.result,l={};l.image=a,l.extension=n,e.setState({background:l})}}}},{key:"onTextChange",value:function(e){this.setState({introduction:e.target.value})}},{key:"render",value:function(){return p.default.createElement("div",{className:"create_class_html"},p.default.createElement("div",{className:"base_page_head"},p.default.createElement("span",{className:"to_back",onClick:this.toBackClick.bind(this)},p.default.createElement(i.default,{type:"rollback"}),this.cls_name),p.default.createElement(l.default,{type:"primary",onClick:this.onCreateClick.bind(this)},"提交")),p.default.createElement("div",null,"主标题： ",p.default.createElement(a.default,{value:this.state.title,onChange:this.onTitleChange.bind(this,"title"),style:{width:300}})),p.default.createElement("div",{className:"cut_line"}),p.default.createElement("div",null,"副标题： ",p.default.createElement(a.default,{value:this.state.sub_title,onChange:this.onTitleChange.bind(this,"sub_title"),style:{width:300}})),p.default.createElement("div",{className:"cut_line"}),p.default.createElement("div",{className:"main_background"},p.default.createElement(l.default,{type:"primary",className:"upload_btn",onClick:this.onUploadImageClick.bind(this)},p.default.createElement(i.default,{type:"upload"}),"上传背景图片"),p.default.createElement("span",{className:"tip"},"图片大小不能超过1M"),p.default.createElement("input",{type:"file",id:"main_input",onChange:this.onChangeImage.bind(this),style:{display:"none"}}),p.default.createElement("img",{src:this.state.background.image})),p.default.createElement("div",{className:"cut_line"}),p.default.createElement("div",{className:"introduction",id:"introduction"},p.default.createElement("div",{className:"title_in"},"课程简介"),p.default.createElement("textarea",{value:this.state.introduction,onChange:this.onTextChange.bind(this)})))}}]),t}(m.Component);t.default=y},722:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=y(n(732)),l=y(n(12)),i=y(n(110)),u=y(n(111)),r=y(n(107)),s=y(n(77)),o=y(n(9)),c=y(n(17)),d=y(n(7)),f=y(n(10)),h=y(n(730));n(733),n(134),n(731);var m=n(0),p=y(m),v=n(228),g=y(n(65)),_=y(n(227));function y(e){return e&&e.__esModule?e:{default:e}}n(912);var k=h.default.Header,b=h.default.Sider,E=h.default.Content,x=[{key:"0",route:"/home",icon:"windows",name:"首页"}],w=function(e){function t(e){(0,o.default)(this,t);var n=(0,d.default)(this,(t.__proto__||(0,s.default)(t)).call(this,e));return console.log(window.location),n.state={collapsed:!1,selectKey:"0",head_width:(0,_.default)(window).width()-200},n}return(0,f.default)(t,e),(0,c.default)(t,[{key:"componentDidMount",value:function(){var e=this,t=window.location.pathname,n=!0,a=!1,l=void 0;try{for(var i,u=(0,r.default)(x);!(n=(i=u.next()).done);n=!0){var s=i.value;if(console.log(s,t),t==s.route){this.setState({selectKey:s.key});break}}}catch(e){a=!0,l=e}finally{try{!n&&u.return&&u.return()}finally{if(a)throw l}}(0,_.default)(window).resize(function(){e.setState({head_width:(0,_.default)(window).width-200})})}},{key:"componentWillUnmount",value:function(){}},{key:"onMenuItemClick",value:function(e){e.item;var t=e.key;e.keyPath,e.domEvent;console.log(t),this.setState({selectKey:t})}},{key:"toggle",value:function(){this.setState({collapsed:!this.state.collapsed})}},{key:"onLogoutClick",value:function(){var e=(0,u.default)(i.default.mark(function e(){var t,n;return i.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t=g.default.cookies.get_cookies(),console.log(t),t){e.next=4;break}return e.abrupt("return");case 4:return e.next=6,g.default.util.confirmDialog("提示","确定退出？");case 6:if(!e.sent){e.next=15;break}return console.log("退出"),e.next=11,g.default.http.postSync(g.default.util.make_url("/logout"),{username:t.username});case 11:n=e.sent,console.log(n),g.default.cookies.del_cookies(),window.location.href="/login";case 15:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"render",value:function(){return p.default.createElement("div",{className:"base_page_html"},p.default.createElement(h.default,null,p.default.createElement(b,{trigger:null,collapsible:!0,collapsed:this.state.collapsed,width:"200"},p.default.createElement("div",{className:"base_page_logo"}),p.default.createElement(a.default,{theme:"dark",mode:"inline",defaultSelectedKeys:[this.state.selectKey],onSelect:this.onMenuItemClick.bind(this),selectedKeys:[this.state.selectKey]},x.map(function(e){return p.default.createElement(a.default.Item,{key:e.key},p.default.createElement(v.Link,{to:e.route},p.default.createElement(l.default,{type:e.icon}),e.name))}))),p.default.createElement(h.default,null,p.default.createElement(k,{style:{background:"#fff",padding:0,position:"fixed",zIndex:1,width:this.state.head_width,marginLeft:0,borderBottom:"1px solid #aaa"}},p.default.createElement(l.default,{className:"trigger",type:this.state.collapsed?"menu-unfold":"menu-fold",onClick:this.toggle.bind(this),style:{marginLeft:20}}),p.default.createElement("div",{className:"logout_button",id:"logout_button",onClick:this.onLogoutClick.bind(this)},p.default.createElement(l.default,{type:"logout",className:"icon"}),"退出")),p.default.createElement(E,{style:{margin:"90px 15px 30px",padding:24,background:"#fff",Height:800,minHeight:700}},this.props.children))))}}]),t}(m.Component);t.default=w},890:function(e,t){},894:function(e,t){},898:function(e,t){},900:function(e,t){},902:function(e,t){},904:function(e,t){},912:function(e,t){}});